class product{constructor(t,e,s,i,l){this._img=t,this._category=e,this._name=s,this._price=i,this._description=l}}class productHandler{constructor(t,e,s,i,l,a,r){if(this._img=t.toString(),this._imgFormatted='src="'+this._img+'"',this._category=this.formatString(e),this._name=this.formatString(s),this._price=parseFloat(i),this._priceFormatted=this._price.toLocaleString("pt-br",{minimumFractionDigits:2,maximumFractionDigits:2}),this._description=l,this._imgTest=regexImage.test(this._img),this._categoryTest=!(this._category.length<1||this._category.length>11),this._nameTest=!(this._name.length<3||this._name.length>12),this._priceTest=!(this._price<.99||this._price>9999.99),this._descriptionTest=!(this._description.length<20||this._description.length>100),!(this._imgTest&&this._categoryTest&&this._nameTest&&this._priceTest&&this._descriptionTest))throw"Invalid data: one or more parameters are not properly formatted.";if(0===a)productListArray.addProduct(new product(this._imgFormatted,this._category,this._name,this._priceFormatted,this._description));else{if(1!==a)throw"Invalid parameter: action should either be 0 (add) or 1 (edit).";productListArray.editProduct(new product(this._imgFormatted,this._category,this._name,this._priceFormatted,this._description),r)}}formatString(t){let e=(t=t.toString().toLocaleLowerCase()).match(/\b[^\s]+/g);for(let t=0;t<e.length;t++){let s=e[t][0].toLocaleUpperCase(),i=(()=>{let s=[];for(let i=1;i<e[t].length;i++)s.push(e[t][i]);return s})();e[t]=s+i.join("")}return e.join(" ")}}class productList{constructor(){this._productList=[]}addProduct(t){this._productList.push(t),localStorage.setItem("productListArray",JSON.stringify(this._productList))}editProduct(t,e){this._productList[e]=t,localStorage.setItem("productListArray",JSON.stringify(this._productList))}}null===sessionStorage.getItem("editProduct")||/\/novo_produto\.html$/.test(window.location.href)||sessionStorage.removeItem("editProduct");const hrefDocument=window.location.href,$=document.querySelector.bind(document),$$=document.querySelectorAll.bind(document),regexHREF=new RegExp(["/index.html$","/lista_produtos.html$","/novo_produto.html$","/produto.html$","/login.html$"].join("|"),"i"),regexHREFLogin=/\/login\.html$/;if(/\b\/index\.html\b/.test(hrefDocument))concatHref=["","html/"];else var concatHref=["../",""];function clearLocalStorage(){localStorage.clear(),sessionStorage.clear(),window.location.href="../html/index.html"}function classResult(t,e){!1===e?(t.classList.add("js__failure"),t.classList.remove("js__success")):!0===e?(t.classList.add("js__success"),t.classList.remove("js__failure")):(t.classList.remove("js__failure"),t.classList.remove("js__success"))}function labelResult(t,e,s){t.innerText=`${e} ${s}`}function addEventListenerForm(t,e,s,i,l,a,r){e.addEventListener(s,s=>{var o=i.length;if(""==e.value)labelResult(t.querySelector("p"),l,""),classResult(t,void 0);else{for(let s=0;s<i.length;s++)i[s].test(e.value)||(labelResult(t.querySelector("p"),a[s],"[X]"),o--);o<i.length?classResult(t,!1):(labelResult(t.querySelector("p"),r,"[✓]"),classResult(t,!0))}})}function clearForm(t,e){let s=t.querySelectorAll("label"),i=t.querySelectorAll("input,textarea");s.forEach((t,s,i)=>{i[s].querySelector("p").innerText=e[s],i[s].classList.remove("js__failure"),i[s].classList.remove("js__success")}),i.forEach((t,e,s)=>{s[e].value=""})}if(regexHREF.test(window.location.href)){var productListArray=new productList;if(null!==localStorage.getItem("productListArray")){var lsArray=JSON.parse(localStorage.getItem("productListArray"));for(let t=0;t<lsArray.length;t++)productListArray._productList[t]=new product(lsArray[t]._img,lsArray[t]._category,lsArray[t]._name,lsArray[t]._price,lsArray[t]._description)}else{function pImgSRC(t){return` \n srcset="img/products/product__${t}--size1.webp 126w,\n img/products/product__${t}--size2.webp 174w,\n img/products/product__${t}--size3.webp 261w,\n img/products/product__${t}--size4.webp 348w"\n sizes="(max-width: 280px) 126px,\n (max-width: 428px) 193px,\n (max-width: 768px) 216px,\n (max-width: 1024px) 296px,\n (max-width: 1280px) 152px,\n 100vw"\n src="img/products/product__${t}--size1.webp" alt="" `}function pName(t){return`Produto #${t}`}function pDesc(){return"Lorem ipsum dolor sit amet. Vel voluptates quaerat et esse amet sed quisquam similique ut obcaecati."}function pGenerate(t,e){for(let s=0;s<6;s++)productListArray._productList.push(new product(pImgSRC(e),t,pName(e),42..toLocaleString("pt-br",{minimumFractionDigits:2,maximumFractionDigits:2}),pDesc())),e++}pGenerate("Star Wars",1),pGenerate("Consoles",7),pGenerate("Diversos",13)}}null===JSON.parse(sessionStorage.getItem("login"))?(alert("Você não está autorizado a acessar esta página."),window.location.replace("../index.html")):!0!==JSON.parse(sessionStorage.getItem("login")).login&&(alert("Você não está autorizado a acessar esta página."),window.location.replace("../index.html"));const messagesDefault=["URL da imagem do produto","Categoria do produto","Nome do produto","Preço do produto","Descrição do produto"],messagesSuccess=["URL da imagem válida","Categoria do produto válida","Nome do produto válido","Preço do produto válido","Descrição do produto válido"],messagesError=["URL da imagem é inválida","Categoria é muito curta","Categoria é muito longa","Nome é muito curto","Nome é muito longo","Preço é muito baixo","Preço é muito alto","Descrição é muito curta","Descrição é muito longa"],regexImage=new RegExp([".webp$",".jpg$",".jpeg$",".gif$",".png$",".apng$",".svg$",".bmp$"].join("|"),"i"),buttonAdd=document.getElementById("buttonAdd"),labelList=$$(".formulario__container"),labelTextList=$$(".formulario__container>.formulario__label"),inputList=$$(".formulario__campo"),formNovoProduto=$(".login__formulario");var inputListStatus=[];for(let t=0;t<5;t++)inputListStatus.push(0);if(null!==sessionStorage.getItem("editProduct")){if((editProduct=JSON.parse(sessionStorage.getItem("editProduct"))).edit){let t=productListArray._productList[editProduct.index];$(".login__titulo").innerText="Editando o produto",inputList[0].value=t._img,inputList[1].value=t._category,inputList[2].value=t._name,inputList[3].value=parseInt(t._price),inputList[4].value=t._description}}else var editProduct={edit:!1,index:-1};inputList[0].addEventListener("focusout",()=>{""==inputList[0].value?(classResult(labelList[0],void 0),labelResult(labelTextList[0],messagesDefault[0],""),inputListStatus[0]=0):regexImage.test(inputList[0].value)?(classResult(labelList[0],!0),labelResult(labelTextList[0],messagesSuccess[0],""),inputListStatus[0]=1):(classResult(labelList[0],!1),labelResult(labelTextList[0],messagesError[0],""),inputListStatus[0]=0)}),inputList[1].addEventListener("focusout",()=>{""==inputList[1].value?(classResult(labelList[1],void 0),labelResult(labelTextList[1],messagesDefault[1],""),inputListStatus[1]=0):inputList[1].value.length<1?(classResult(labelList[1],!1),labelResult(labelTextList[1],messagesError[1],""),inputListStatus[1]=0):inputList[1].value.length>11?(classResult(labelList[1],!1),labelResult(labelTextList[1],messagesError[2],""),inputListStatus[1]=0):(classResult(labelList[1],!0),labelResult(labelTextList[1],messagesSuccess[1],""),inputListStatus[1]=1)}),inputList[2].addEventListener("focusout",()=>{""==inputList[2].value?(classResult(labelList[2],void 0),labelResult(labelTextList[2],messagesDefault[2],""),inputListStatus[2]=0):inputList[2].value.length<3?(classResult(labelList[2],!1),labelResult(labelTextList[2],messagesError[3],""),inputListStatus[2]=0):inputList[2].value.length>12?(classResult(labelList[2],!1),labelResult(labelTextList[2],messagesError[4],""),inputListStatus[2]=0):(classResult(labelList[2],!0),labelResult(labelTextList[2],messagesSuccess[2],""),inputListStatus[2]=1)}),inputList[3].addEventListener("focusout",()=>{""==inputList[3].value?(classResult(labelList[3],void 0),labelResult(labelTextList[3],messagesDefault[3],""),inputListStatus[3]=0):inputList[3].value<.99?(classResult(labelList[3],!1),labelResult(labelTextList[3],messagesError[5],""),inputListStatus[3]=0):inputList[3].value>9999.99?(classResult(labelList[3],!1),labelResult(labelTextList[3],messagesError[6],""),inputListStatus[3]=0):(classResult(labelList[3],!0),labelResult(labelTextList[3],messagesSuccess[3],""),inputListStatus[3]=1)}),inputList[4].addEventListener("focusout",()=>{""==inputList[4].value?(classResult(labelList[4],void 0),labelResult(labelTextList[4],messagesDefault[4],""),inputListStatus[4]=0):inputList[4].value.length<20?(classResult(labelList[4],!1),labelResult(labelTextList[4],messagesError[7],""),inputListStatus[4]=0):inputList[4].value.length>100?(classResult(labelList[4],!1),labelResult(labelTextList[4],messagesError[8],""),inputListStatus[4]=0):(classResult(labelList[4],!0),labelResult(labelTextList[4],messagesSuccess[4],""),inputListStatus[4]=1)}),buttonAdd.addEventListener("click",t=>{if(t.preventDefault(),inputListStatus.includes(0))alert("Os campos não foram preenchidos corretamente!");else if(editProduct.edit){let t=(()=>{var t=$("form").querySelectorAll("label>input,label>textarea"),e=[];for(let s=0;s<t.length;s++)e[s]=t[s].value;return e})();new productHandler(t[0],t[1],t[2],t[3],t[4],1,editProduct.index),clearForm(formNovoProduto,messagesDefault),sessionStorage.removeItem("editProduct"),window.location.href="../html/lista_produtos.html"}else{let t=(()=>{var t=$("form").querySelectorAll("label>input,label>textarea"),e=[];for(let s=0;s<t.length;s++)e[s]=t[s].value;return e})();new productHandler(t[0],t[1],t[2],t[3],t[4],0,editProduct.index),clearForm(formNovoProduto,messagesDefault)}});